<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XFire - Skirmish RTS</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%231a1a2e'/><text x='50' y='70' font-size='60' fill='%23ff6600' text-anchor='middle' font-weight='bold'>X</text></svg>">
    <link rel="stylesheet" href="styles.css">
    <script src="constants.js"></script>
    <script src="assetLoader.js"></script>
    <script src="spriteGenerator.js"></script>
    <script src="loadCustomAssets.js"></script>
    <script>
        // Preload background image before initializing game
        window.addEventListener('DOMContentLoaded', () => {
            const bgImg = new Image();
            bgImg.src = 'assets/mainmenu-bg.png';
            bgImg.onload = () => {
                console.log('✓ Background image loaded');
            };
            bgImg.onerror = () => {
                console.log('⚠ Background image not found, using gradient fallback');
            };
        });
    </script>
</head>
<body>
    <div id="header">
        <h1>XFIRE</h1>
        <div id="gameStatus">
            <div class="status-bar">
                <span>Your Army:</span>
                <div class="unit-count" id="playerUnits">0 units</div>
            </div>
            <div class="status-bar">
                <span>Enemy Army:</span>
                <div class="unit-count" id="enemyUnits">0 units</div>
            </div>
        </div>
        <div id="resources">
            <div class="resource">
                <span class="resource-icon">&#9981;</span>
                <span>Oil: <strong id="oil">1200</strong></span>
            </div>
            <div class="resource">
                <span class="resource-icon">&#9889;</span>
                <span>Power: <strong id="power">100</strong></span>
            </div>
        </div>
    </div>

    <div id="gameContainer">
        <canvas id="canvas" width="1000" height="600"></canvas>
        <div id="sidebar">
            <div class="panel">
                <h3>Minimap</h3>
                <canvas id="minimap" width="480" height="480"></canvas>
            </div>
            <div class="panel">
                <h3>Selection</h3>
                <div id="selectionInfo">No selection</div>
            </div>
            <div class="panel">
                <h3>Build <span class="hotkey">[B]</span></h3>
                <div id="buildMenu"></div>
            </div>
        </div>
    </div>

    <div id="footer">
        <span id="controlsHelp">Controls: Left-click select | Right-click move/attack | Drag to box-select | WASD/Arrows scroll | 1-5 unit groups</span>
        <span id="timerDisplay" style="float: right; display: none;">Time: <strong id="gameTimer">0:00</strong></span>
    </div>

    <!-- Background Music -->
    <audio id="introMusic">
        <source src="music/intro.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <audio id="backgroundMusic" loop>
        <source src="music/background.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- Main Menu Screen -->
    <div id="mainMenu" class="fullscreen-overlay">
        <div class="menu-container">
            <div class="menu-buttons">
                <button id="newGameBtn" class="menu-btn">New Game</button>
                <button id="settingsBtn" class="menu-btn secondary">Settings</button>
            </div>
        </div>
    </div>

    <!-- Settings Menu Screen -->
    <div id="settingsMenu" class="fullscreen-overlay hidden">
        <div class="menu-container">
            <h1 class="menu-title">Game Settings</h1>
            <div class="settings-panel">
                <div class="setting-group">
                    <label>Time Limit:</label>
                    <select id="timeLimitSelect">
                        <option value="unlimited">Unlimited</option>
                        <option value="5">5 Minutes</option>
                        <option value="10">10 Minutes</option>
                        <option value="20" selected>20 Minutes</option>
                        <option value="30">30 Minutes</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>AI Difficulty:</label>
                    <select id="difficultySelect">
                        <option value="easy">Easy</option>
                        <option value="normal" selected>Normal</option>
                        <option value="hard">Hard</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>Map Size:</label>
                    <select id="mapSizeSelect">
                        <option value="small">Small (32x32)</option>
                        <option value="medium" selected>Medium (64x64)</option>
                        <option value="large">Large (96x96)</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>Starting Oil:</label>
                    <select id="startingOilSelect">
                        <option value="500">500</option>
                        <option value="1000">1000</option>
                        <option value="1200" selected>1200</option>
                        <option value="2000">2000</option>
                    </select>
                </div>
            </div>
            <div class="menu-buttons">
                <button id="startGameBtn" class="menu-btn">Start Game</button>
                <button id="backBtn" class="menu-btn secondary">Back</button>
            </div>
        </div>
    </div>

    <!-- Pause Screen -->
    <div id="pauseScreen" class="fullscreen-overlay hidden">
        <div class="menu-container">
            <h1 class="menu-title">PAUSED</h1>
            <div class="menu-buttons">
                <button id="resumeBtn" class="menu-btn">Resume (P)</button>
                <button id="quitBtn" class="menu-btn secondary">Quit to Menu</button>
            </div>
        </div>
    </div>

    <!-- Victory Screen -->
    <div id="victoryScreen" class="fullscreen-overlay hidden">
        <div class="menu-container">
            <h1 class="menu-title victory-title">VICTORY!</h1>
            <p class="victory-info">You have defeated all enemy forces!</p>
            <div id="victoryStats" class="stats-box"></div>
            <div class="menu-buttons">
                <button id="playAgainBtn" class="menu-btn">Play Again</button>
                <button class="menu-btn secondary menu-return">Main Menu</button>
            </div>
        </div>
    </div>

    <!-- Defeat Screen -->
    <div id="defeatScreen" class="fullscreen-overlay hidden">
        <div class="menu-container">
            <h1 class="menu-title defeat-title">DEFEAT!</h1>
            <p class="defeat-info">All your forces have been eliminated.</p>
            <div id="defeatStats" class="stats-box"></div>
            <div class="menu-buttons">
                <button id="retryBtn" class="menu-btn">Retry</button>
                <button class="menu-btn secondary menu-return">Main Menu</button>
            </div>
        </div>
    </div>

    <script defer src="game-engine.js?v=3"></script>
</body>
</html>
